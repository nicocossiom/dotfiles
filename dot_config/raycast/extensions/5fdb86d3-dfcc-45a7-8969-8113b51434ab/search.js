"use strict";var Nn=Object.create;var Fe=Object.defineProperty;var Un=Object.getOwnPropertyDescriptor;var Mn=Object.getOwnPropertyNames;var Gn=Object.getPrototypeOf,Dn=Object.prototype.hasOwnProperty;var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Bn=(e,t)=>{for(var r in t)Fe(e,r,{get:t[r],enumerable:!0})},zt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Mn(t))!Dn.call(e,n)&&n!==r&&Fe(e,n,{get:()=>t[n],enumerable:!(o=Un(t,n))||o.enumerable});return e};var B=(e,t,r)=>(r=e!=null?Nn(Gn(e)):{},zt(t||!e||!e.__esModule?Fe(r,"default",{value:e,enumerable:!0}):r,e)),Hn=e=>zt(Fe({},"__esModule",{value:!0}),e);var nr=P((ha,or)=>{or.exports=rr;rr.sync=Yn;var er=require("fs");function qn(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var o=0;o<r.length;o++){var n=r[o].toLowerCase();if(n&&e.substr(-n.length).toLowerCase()===n)return!0}return!1}function tr(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:qn(t,r)}function rr(e,t,r){er.stat(e,function(o,n){r(o,o?!1:tr(n,e,t))})}function Yn(e,t){return tr(er.statSync(e),e,t)}});var lr=P((ya,cr)=>{cr.exports=ir;ir.sync=zn;var sr=require("fs");function ir(e,t,r){sr.stat(e,function(o,n){r(o,o?!1:ar(n,t))})}function zn(e,t){return ar(sr.statSync(e),t)}function ar(e,t){return e.isFile()&&Xn(e,t)}function Xn(e,t){var r=e.mode,o=e.uid,n=e.gid,s=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),i=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),l=parseInt("001",8),p=a|c,u=r&l||r&c&&n===i||r&a&&o===s||r&p&&s===0;return u}});var dr=P((wa,ur)=>{var ga=require("fs"),Ue;process.platform==="win32"||global.TESTING_WINDOWS?Ue=nr():Ue=lr();ur.exports=at;at.sync=Jn;function at(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(o,n){at(e,t||{},function(s,i){s?n(s):o(i)})})}Ue(e,t||{},function(o,n){o&&(o.code==="EACCES"||t&&t.ignoreErrors)&&(o=null,n=!1),r(o,n)})}function Jn(e,t){try{return Ue.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var wr=P((Sa,gr)=>{var me=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",pr=require("path"),Qn=me?";":":",mr=dr(),fr=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),hr=(e,t)=>{let r=t.colon||Qn,o=e.match(/\//)||me&&e.match(/\\/)?[""]:[...me?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],n=me?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=me?n.split(r):[""];return me&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:o,pathExt:s,pathExtExe:n}},yr=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:o,pathExt:n,pathExtExe:s}=hr(e,t),i=[],a=l=>new Promise((p,u)=>{if(l===o.length)return t.all&&i.length?p(i):u(fr(e));let y=o[l],d=/^".*"$/.test(y)?y.slice(1,-1):y,w=pr.join(d,e),b=!d&&/^\.[\\\/]/.test(e)?e.slice(0,2)+w:w;p(c(b,l,0))}),c=(l,p,u)=>new Promise((y,d)=>{if(u===n.length)return y(a(p+1));let w=n[u];mr(l+w,{pathExt:s},(b,D)=>{if(!b&&D)if(t.all)i.push(l+w);else return y(l+w);return y(c(l,p,u+1))})});return r?a(0).then(l=>r(null,l),r):a(0)},Zn=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:o,pathExtExe:n}=hr(e,t),s=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,l=pr.join(c,e),p=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+l:l;for(let u=0;u<o.length;u++){let y=p+o[u];try{if(mr.sync(y,{pathExt:n}))if(t.all)s.push(y);else return y}catch{}}}if(t.all&&s.length)return s;if(t.nothrow)return null;throw fr(e)};gr.exports=yr;yr.sync=Zn});var Ir=P((Ia,ct)=>{"use strict";var Sr=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(o=>o.toUpperCase()==="PATH")||"Path"};ct.exports=Sr;ct.exports.default=Sr});var Er=P((Pa,br)=>{"use strict";var Pr=require("path"),es=wr(),ts=Ir();function xr(e,t){let r=e.options.env||process.env,o=process.cwd(),n=e.options.cwd!=null,s=n&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(e.options.cwd)}catch{}let i;try{i=es.sync(e.command,{path:r[ts({env:r})],pathExt:t?Pr.delimiter:void 0})}catch{}finally{s&&process.chdir(o)}return i&&(i=Pr.resolve(n?e.options.cwd:"",i)),i}function rs(e){return xr(e)||xr(e,!0)}br.exports=rs});var Tr=P((xa,ut)=>{"use strict";var lt=/([()\][%!^"`<>&|;, *?])/g;function os(e){return e=e.replace(lt,"^$1"),e}function ns(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(lt,"^$1"),t&&(e=e.replace(lt,"^$1")),e}ut.exports.command=os;ut.exports.argument=ns});var vr=P((ba,Cr)=>{"use strict";Cr.exports=/^#!(.*)/});var kr=P((Ea,Ar)=>{"use strict";var ss=vr();Ar.exports=(e="")=>{let t=e.match(ss);if(!t)return null;let[r,o]=t[0].replace(/#! ?/,"").split(" "),n=r.split("/").pop();return n==="env"?o:o?`${n} ${o}`:n}});var Lr=P((Ta,Rr)=>{"use strict";var dt=require("fs"),is=kr();function as(e){let r=Buffer.alloc(150),o;try{o=dt.openSync(e,"r"),dt.readSync(o,r,0,150,0),dt.closeSync(o)}catch{}return is(r.toString())}Rr.exports=as});var Fr=P((Ca,_r)=>{"use strict";var cs=require("path"),Or=Er(),Vr=Tr(),ls=Lr(),us=process.platform==="win32",ds=/\.(?:com|exe)$/i,ps=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ms(e){e.file=Or(e);let t=e.file&&ls(e.file);return t?(e.args.unshift(e.file),e.command=t,Or(e)):e.file}function fs(e){if(!us)return e;let t=ms(e),r=!ds.test(t);if(e.options.forceShell||r){let o=ps.test(t);e.command=cs.normalize(e.command),e.command=Vr.command(e.command),e.args=e.args.map(s=>Vr.argument(s,o));let n=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${n}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function hs(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let o={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?o:fs(o)}_r.exports=hs});var Mr=P((va,Ur)=>{"use strict";var pt=process.platform==="win32";function mt(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function ys(e,t){if(!pt)return;let r=e.emit;e.emit=function(o,n){if(o==="exit"){let s=Nr(n,t,"spawn");if(s)return r.call(e,"error",s)}return r.apply(e,arguments)}}function Nr(e,t){return pt&&e===1&&!t.file?mt(t.original,"spawn"):null}function gs(e,t){return pt&&e===1&&!t.file?mt(t.original,"spawnSync"):null}Ur.exports={hookChildProcess:ys,verifyENOENT:Nr,verifyENOENTSync:gs,notFoundError:mt}});var Br=P((Aa,fe)=>{"use strict";var Gr=require("child_process"),ft=Fr(),ht=Mr();function Dr(e,t,r){let o=ft(e,t,r),n=Gr.spawn(o.command,o.args,o.options);return ht.hookChildProcess(n,o),n}function ws(e,t,r){let o=ft(e,t,r),n=Gr.spawnSync(o.command,o.args,o.options);return n.error=n.error||ht.verifyENOENTSync(n.status,o),n}fe.exports=Dr;fe.exports.spawn=Dr;fe.exports.sync=ws;fe.exports._parse=ft;fe.exports._enoent=ht});var eo=P((qa,Be)=>{Be.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&Be.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&Be.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var so=P((Ya,we)=>{var g=global.process,ne=function(e){return e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function"};ne(g)?(to=require("assert"),ye=eo(),ro=/^win/i.test(g.platform),ve=require("events"),typeof ve!="function"&&(ve=ve.EventEmitter),g.__signal_exit_emitter__?x=g.__signal_exit_emitter__:(x=g.__signal_exit_emitter__=new ve,x.count=0,x.emitted={}),x.infinite||(x.setMaxListeners(1/0),x.infinite=!0),we.exports=function(e,t){if(!ne(global.process))return function(){};to.equal(typeof e,"function","a callback must be provided for exit handler"),ge===!1&&It();var r="exit";t&&t.alwaysLast&&(r="afterexit");var o=function(){x.removeListener(r,e),x.listeners("exit").length===0&&x.listeners("afterexit").length===0&&He()};return x.on(r,e),o},He=function(){!ge||!ne(global.process)||(ge=!1,ye.forEach(function(t){try{g.removeListener(t,$e[t])}catch{}}),g.emit=We,g.reallyExit=Pt,x.count-=1)},we.exports.unload=He,se=function(t,r,o){x.emitted[t]||(x.emitted[t]=!0,x.emit(t,r,o))},$e={},ye.forEach(function(e){$e[e]=function(){if(!!ne(global.process)){var r=g.listeners(e);r.length===x.count&&(He(),se("exit",null,e),se("afterexit",null,e),ro&&e==="SIGHUP"&&(e="SIGINT"),g.kill(g.pid,e))}}}),we.exports.signals=function(){return ye},ge=!1,It=function(){ge||!ne(global.process)||(ge=!0,x.count+=1,ye=ye.filter(function(t){try{return g.on(t,$e[t]),!0}catch{return!1}}),g.emit=no,g.reallyExit=oo)},we.exports.load=It,Pt=g.reallyExit,oo=function(t){!ne(global.process)||(g.exitCode=t||0,se("exit",g.exitCode,null),se("afterexit",g.exitCode,null),Pt.call(g,g.exitCode))},We=g.emit,no=function(t,r){if(t==="exit"&&ne(global.process)){r!==void 0&&(g.exitCode=r);var o=We.apply(this,arguments);return se("exit",g.exitCode,null),se("afterexit",g.exitCode,null),o}else return We.apply(this,arguments)}):we.exports=function(){return function(){}};var to,ye,ro,ve,x,He,se,$e,ge,It,Pt,oo,We,no});var yo=P((Ja,ho)=>{"use strict";var{PassThrough:Hs}=require("stream");ho.exports=e=>{e={...e};let{array:t}=e,{encoding:r}=e,o=r==="buffer",n=!1;t?n=!(r||o):r=r||"utf8",o&&(r=null);let s=new Hs({objectMode:n});r&&s.setEncoding(r);let i=0,a=[];return s.on("data",c=>{a.push(c),n?i=a.length:i+=c.length}),s.getBufferedValue=()=>t?a:o?Buffer.concat(a,i):a.join(""),s.getBufferedLength=()=>i,s}});var go=P((Qa,Ae)=>{"use strict";var{constants:$s}=require("buffer"),Ws=require("stream"),{promisify:js}=require("util"),Ks=yo(),qs=js(Ws.pipeline),je=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function xt(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};let{maxBuffer:r}=t,o=Ks(t);return await new Promise((n,s)=>{let i=a=>{a&&o.getBufferedLength()<=$s.MAX_LENGTH&&(a.bufferedData=o.getBufferedValue()),s(a)};(async()=>{try{await qs(e,o),n()}catch(a){i(a)}})(),o.on("data",()=>{o.getBufferedLength()>r&&i(new je)})}),o.getBufferedValue()}Ae.exports=xt;Ae.exports.buffer=(e,t)=>xt(e,{...t,encoding:"buffer"});Ae.exports.array=(e,t)=>xt(e,{...t,array:!0});Ae.exports.MaxBufferError=je});var So=P((Za,wo)=>{"use strict";var{PassThrough:Ys}=require("stream");wo.exports=function(){var e=[],t=new Ys({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=o,t.on("unpipe",n),Array.prototype.slice.call(arguments).forEach(r),t;function r(s){return Array.isArray(s)?(s.forEach(r),this):(e.push(s),s.once("end",n.bind(null,s)),s.once("error",t.emit.bind(t,"error")),s.pipe(t,{end:!1}),this)}function o(){return e.length==0}function n(s){e=e.filter(function(i){return i!==s}),!e.length&&t.readable&&t.end()}}});var ia={};Bn(ia,{default:()=>sa});module.exports=Hn(ia);var te=require("@raycast/api");var pe=require("@raycast/api"),Zt=require("react");var re=require("@raycast/api"),be=require("react/jsx-runtime"),Xt="```",Jt="https://bitwarden.com/help/cli/#download-and-install",$n="https://formulae.brew.sh/formula/bitwarden-cli",Wn="https://github.com/raycast/extensions/issues/new?assignees=&labels=extension%2Cbug&template=extension_bug_report.yml&title=%5BBitwarden%5D+...",jn=e=>`# \u{1F6A8} Something went wrong
${e?`${Xt}
${e}
${Xt}`:`
`}
## Troubleshooting Guide:

1. The [Bitwarden CLI](${Jt}) is correctly installed
2. If you did not install the Bitwarden CLI [using Homebrew](${$n}), please check that the path of the installation matches the \`Bitwarden CLI Installation Path\` extension setting. 
    - \u{1F4A1} Run the \`which bw\` command to check the CLI installation path.

If you are still experiencing issues, please [open an issue on GitHub](${Wn}).
`,Kn=e=>(0,be.jsx)(re.Detail,{markdown:jn(e.errorInfo),actions:(0,be.jsxs)(re.ActionPanel,{children:[(0,be.jsx)(re.Action.CopyToClipboard,{title:"Copy Homebrew Installation Command",content:"brew install bitwarden-cli"}),(0,be.jsx)(re.Action.OpenInBrowser,{title:"Open Installation Guide",url:Jt})]})}),st=Kn;var ue=class extends Error{constructor(t){super(t)}},Ee=class extends ue{constructor(t){super(t)}},Ne=class extends Ee{constructor(t){super(t??"Bitwarden CLI not found"),this.name="CLINotFoundError"}},oe=class extends ue{constructor(t){super(t??"Failed to load vault items"),this.name="FailedToLoadVaultItemsError"}},de=class extends Ee{constructor(t){super(t??"Vault is locked"),this.name="VaultIsLockedError"}};function it(e){if(e instanceof Ee)return e.message}var Qt=require("react/jsx-runtime"),Te=class extends Zt.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}async componentDidCatch(t,r){t instanceof ue?(this.setState(o=>({...o,hasError:!0,error:t.message})),await(0,pe.showToast)(pe.Toast.Style.Failure,t.message)):(pe.environment.isDevelopment&&this.setState(o=>({...o,hasError:!0,error:t.message})),console.error("Error:",t,r))}render(){try{return this.state.hasError?(0,Qt.jsx)(st,{errorInfo:this.state.error}):this.props.children}catch{return(0,Qt.jsx)(st,{})}}};var C=require("@raycast/api");var Bo=require("@raycast/api"),X=require("react");var E=require("@raycast/api");var Ao=require("node:buffer"),ko=B(require("node:path"),1),At=B(require("node:child_process"),1),ke=B(require("node:process"),1),Ro=B(Br(),1);function yt(e){let t=typeof e=="string"?`
`:`
`.charCodeAt(),r=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}var Ce=B(require("node:process"),1),he=B(require("node:path"),1),Hr=B(require("node:url"),1);function Me(e={}){let{env:t=process.env,platform:r=process.platform}=e;return r!=="win32"?"PATH":Object.keys(t).reverse().find(o=>o.toUpperCase()==="PATH")||"Path"}function Ss(e={}){let{cwd:t=Ce.default.cwd(),path:r=Ce.default.env[Me()],execPath:o=Ce.default.execPath}=e,n,s=t instanceof URL?Hr.default.fileURLToPath(t):t,i=he.default.resolve(s),a=[];for(;n!==i;)a.push(he.default.join(i,"node_modules/.bin")),n=i,i=he.default.resolve(i,"..");return a.push(he.default.resolve(s,o,"..")),[...a,r].join(he.default.delimiter)}function $r({env:e=Ce.default.env,...t}={}){e={...e};let r=Me({env:e});return t.path=e[r],e[r]=Ss(t),e}var Is=(e,t,r,o)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let n=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!Ps(n,s)&&o||Object.defineProperty(e,r,s)},Ps=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},xs=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},bs=(e,t)=>`/* Wrapped ${e}*/
${t}`,Es=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Ts=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Cs=(e,t,r)=>{let o=r===""?"":`with ${r.trim()}() `,n=bs.bind(null,o,t.toString());Object.defineProperty(n,"name",Ts),Object.defineProperty(e,"toString",{...Es,value:n})};function gt(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:o}=e;for(let n of Reflect.ownKeys(t))Is(e,t,n,r);return xs(e,t),Cs(e,t,o),e}var Ge=new WeakMap,Wr=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,o=0,n=e.displayName||e.name||"<anonymous>",s=function(...i){if(Ge.set(s,++o),o===1)r=e.apply(this,i),e=null;else if(t.throw===!0)throw new Error(`Function \`${n}\` can only be called once`);return r};return gt(s,e),Ge.set(s,o),s};Wr.callCount=e=>{if(!Ge.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return Ge.get(e)};var jr=Wr;var Jr=require("node:os");var Kr=function(){let e=Yr-qr+1;return Array.from({length:e},vs)},vs=function(e,t){return{name:`SIGRT${t+1}`,number:qr+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},qr=34,Yr=64;var Xr=require("node:os");var zr=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var wt=function(){let e=Kr();return[...zr,...e].map(As)},As=function({name:e,number:t,description:r,action:o,forced:n=!1,standard:s}){let{signals:{[e]:i}}=Xr.constants,a=i!==void 0;return{name:e,number:a?i:t,description:r,supported:a,action:o,forced:n,standard:s}};var ks=function(){let e=wt();return Object.fromEntries(e.map(Rs))},Rs=function({name:e,number:t,description:r,supported:o,action:n,forced:s,standard:i}){return[e,{name:e,number:t,description:r,supported:o,action:n,forced:s,standard:i}]},Qr=ks(),Ls=function(){let e=wt(),t=64+1,r=Array.from({length:t},(o,n)=>Os(n,e));return Object.assign({},...r)},Os=function(e,t){let r=Vs(e,t);if(r===void 0)return{};let{name:o,description:n,supported:s,action:i,forced:a,standard:c}=r;return{[e]:{name:o,number:e,description:n,supported:s,action:i,forced:a,standard:c}}},Vs=function(e,t){let r=t.find(({name:o})=>Jr.constants.signals[o]===e);return r!==void 0?r:t.find(o=>o.number===e)},Ha=Ls();var _s=({timedOut:e,timeout:t,errorCode:r,signal:o,signalDescription:n,exitCode:s,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:o!==void 0?`was killed with ${o} (${n})`:s!==void 0?`failed with exit code ${s}`:"failed",St=({stdout:e,stderr:t,all:r,error:o,signal:n,exitCode:s,command:i,escapedCommand:a,timedOut:c,isCanceled:l,killed:p,parsed:{options:{timeout:u}}})=>{s=s===null?void 0:s,n=n===null?void 0:n;let y=n===void 0?void 0:Qr[n].description,d=o&&o.code,b=`Command ${_s({timedOut:c,timeout:u,errorCode:d,signal:n,signalDescription:y,exitCode:s,isCanceled:l})}: ${i}`,D=Object.prototype.toString.call(o)==="[object Error]",z=D?`${b}
${o.message}`:b,le=[z,t,e].filter(Boolean).join(`
`);return D?(o.originalMessage=o.message,o.message=le):o=new Error(le),o.shortMessage=z,o.command=i,o.escapedCommand=a,o.exitCode=s,o.signal=n,o.signalDescription=y,o.stdout=e,o.stderr=t,r!==void 0&&(o.all=r),"bufferedData"in o&&delete o.bufferedData,o.failed=!0,o.timedOut=Boolean(c),o.isCanceled=l,o.killed=p&&!c,o};var De=["stdin","stdout","stderr"],Fs=e=>De.some(t=>e[t]!==void 0),Zr=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return De.map(o=>e[o]);if(Fs(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${De.map(o=>`\`${o}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,De.length);return Array.from({length:r},(o,n)=>t[n])};var io=B(require("node:os"),1),ao=B(so(),1),Ns=1e3*5,co=(e,t="SIGTERM",r={})=>{let o=e(t);return Us(e,t,r,o),o},Us=(e,t,r,o)=>{if(!Ms(t,r,o))return;let n=Ds(r),s=setTimeout(()=>{e("SIGKILL")},n);s.unref&&s.unref()},Ms=(e,{forceKillAfterTimeout:t},r)=>Gs(e)&&t!==!1&&r,Gs=e=>e===io.default.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Ds=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return Ns;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},lo=(e,t)=>{e.kill()&&(t.isCanceled=!0)},Bs=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},uo=(e,{timeout:t,killSignal:r="SIGTERM"},o)=>{if(t===0||t===void 0)return o;let n,s=new Promise((a,c)=>{n=setTimeout(()=>{Bs(e,r,c)},t)}),i=o.finally(()=>{clearTimeout(n)});return Promise.race([s,i])},po=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},mo=async(e,{cleanup:t,detached:r},o)=>{if(!t||r)return o;let n=(0,ao.default)(()=>{e.kill()});return o.finally(()=>{n()})};function fo(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}var Tt=B(go(),1),Io=B(So(),1),Po=(e,t)=>{t!==void 0&&(fo(t)?t.pipe(e.stdin):e.stdin.end(t))},xo=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=(0,Io.default)();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},bt=async(e,t)=>{if(!(!e||t===void 0)){e.destroy();try{return await t}catch(r){return r.bufferedData}}},Et=(e,{encoding:t,buffer:r,maxBuffer:o})=>{if(!(!e||!r))return t?(0,Tt.default)(e,{encoding:t,maxBuffer:o}):Tt.default.buffer(e,{maxBuffer:o})},bo=async({stdout:e,stderr:t,all:r},{encoding:o,buffer:n,maxBuffer:s},i)=>{let a=Et(e,{encoding:o,buffer:n,maxBuffer:s}),c=Et(t,{encoding:o,buffer:n,maxBuffer:s}),l=Et(r,{encoding:o,buffer:n,maxBuffer:s*2});try{return await Promise.all([i,a,c,l])}catch(p){return Promise.all([{error:p,signal:p.signal,timedOut:p.timedOut},bt(e,a),bt(t,c),bt(r,l)])}};var zs=(async()=>{})().constructor.prototype,Xs=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(zs,e)]),Ct=(e,t)=>{for(let[r,o]of Xs){let n=typeof t=="function"?(...s)=>Reflect.apply(o.value,t(),s):o.value.bind(t);Reflect.defineProperty(e,r,{...o,value:n})}return e},Eo=e=>new Promise((t,r)=>{e.on("exit",(o,n)=>{t({exitCode:o,signal:n})}),e.on("error",o=>{r(o)}),e.stdin&&e.stdin.on("error",o=>{r(o)})});var To=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],Js=/^[\w.-]+$/,Qs=/"/g,Zs=e=>typeof e!="string"||Js.test(e)?e:`"${e.replace(Qs,'\\"')}"`,Co=(e,t)=>To(e,t).join(" "),vo=(e,t)=>To(e,t).map(r=>Zs(r)).join(" ");var ei=1e3*1e3*100,ti=({env:e,extendEnv:t,preferLocal:r,localDir:o,execPath:n})=>{let s=t?{...ke.default.env,...e}:e;return r?$r({env:s,cwd:o,execPath:n}):s},ri=(e,t,r={})=>{let o=Ro.default._parse(e,t,r);return e=o.command,t=o.args,r=o.options,r={maxBuffer:ei,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||ke.default.cwd(),execPath:ke.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=ti(r),r.stdio=Zr(r),ke.default.platform==="win32"&&ko.default.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:o}},vt=(e,t,r)=>typeof t!="string"&&!Ao.Buffer.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?yt(t):t;function Lo(e,t,r){let o=ri(e,t,r),n=Co(e,t),s=vo(e,t);po(o.options);let i;try{i=At.default.spawn(o.file,o.args,o.options)}catch(d){let w=new At.default.ChildProcess,b=Promise.reject(St({error:d,stdout:"",stderr:"",all:"",command:n,escapedCommand:s,parsed:o,timedOut:!1,isCanceled:!1,killed:!1}));return Ct(w,b)}let a=Eo(i),c=uo(i,o.options,a),l=mo(i,o.options,c),p={isCanceled:!1};i.kill=co.bind(null,i.kill.bind(i)),i.cancel=lo.bind(null,i,p);let y=jr(async()=>{let[{error:d,exitCode:w,signal:b,timedOut:D},z,le,Fn]=await bo(i,o.options,l),jt=vt(o.options,z),Kt=vt(o.options,le),qt=vt(o.options,Fn);if(d||w!==0||b!==null){let Yt=St({error:d,exitCode:w,signal:b,stdout:jt,stderr:Kt,all:qt,command:n,escapedCommand:s,parsed:o,timedOut:D,isCanceled:p.isCanceled||(o.options.signal?o.options.signal.aborted:!1),killed:i.killed});if(!o.options.reject)return Yt;throw Yt}return{command:n,escapedCommand:s,exitCode:0,stdout:jt,stderr:Kt,all:qt,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return Po(i,o.options.input),i.all=xo(i,o.options),Ct(i,y)}var Mo=require("fs"),Go=require("path/posix");var Oo="https://bitwarden.com",Re="HIDDEN-VALUE",T={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason"};var oi=require("@raycast/api"),_o=require("crypto");var Vo="foobarbazzybaz";function Fo(e){return Object.entries(e).flatMap(([t,r])=>r?[`--${t}`,r]:[])}async function kt(e){return new Promise((t,r)=>{(0,_o.pbkdf2)(e,Vo,1e5,64,"sha512",(o,n)=>{if(o!=null){r(o);return}t(n.toString("hex"))})})}var Le=require("@raycast/api");var N={IMMEDIATELY:0,ONE_MINUTE:6e4,FIVE_MINUTES:3e5,FIFTEEN_MINUTES:9e5,THIRTY_MINUTES:18e5,ONE_HOUR:36e5,FOUR_HOURS:144e5,EIGHT_HOURS:288e5,ONE_DAY:864e5,NEVER:-1},No={[N.IMMEDIATELY]:"Immediately",[N.ONE_MINUTE]:"1 Minute",[N.FIVE_MINUTES]:"5 Minutes",[N.FIFTEEN_MINUTES]:"15 Minutes",[N.THIRTY_MINUTES]:"30 Minutes",[N.ONE_HOUR]:"1 Hour",[N.FOUR_HOURS]:"4 Hours",[N.EIGHT_HOURS]:"8 Hours",[N.ONE_DAY]:"1 Day"};function Ke(){let{serverUrl:e}=(0,Le.getPreferenceValues)();return e===""||e==="bitwarden.com"||e==="https://bitwarden.com"?"":e}var ni={search:"transientCopySearch","generate-password":"transientCopyGeneratePassword","generate-password-quick":"transientCopyGeneratePasswordQuick"};function V(e){let t=ni[Le.environment.commandName],r=(0,Le.getPreferenceValues)()[t];return r==="never"?!1:r==="always"?!0:r==="passwords"?e==="password":!0}function Uo(e){return No[e]}var qe=class{constructor(){this.callbacks={};let{cliPath:t,clientId:r,clientSecret:o,serverCertsPath:n}=(0,E.getPreferenceValues)(),s=Ke();if(this.cliPath=t||(process.arch=="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"),!(0,Mo.existsSync)(this.cliPath))throw new Ne(`Bitwarden CLI not found at ${this.cliPath}`);this.env={BITWARDENCLI_APPDATA_DIR:E.environment.supportPath,BW_CLIENTSECRET:o.trim(),BW_CLIENTID:r.trim(),PATH:(0,Go.dirname)(process.execPath),...s&&n?{NODE_EXTRA_CA_CERTS:n}:{}},this.initPromise=(async()=>{await this.checkServerUrl(s),this.lockReason=await E.LocalStorage.getItem(T.VAULT_LOCK_REASON)})()}setActionCallback(t,r){return this.callbacks[t]=r,this}setSessionToken(t){this.env={...this.env,BW_SESSION:t}}clearSessionToken(){delete this.env.BW_SESSION}withSession(t){return this.tempSessionToken=t,this}async initialize(){return await this.initPromise,this}async checkServerUrl(t){if((await E.LocalStorage.getItem(T.SERVER_URL)||"")===t)return;let o=await(0,E.showToast)({style:E.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",t||Oo]),await E.LocalStorage.setItem(T.SERVER_URL,t),o.style=E.Toast.Style.Success,o.title="Success",o.message="Bitwarden server changed"}catch(n){o.style=E.Toast.Style.Failure,o.title="Failed to switch server",n instanceof Error?o.message=n.message:o.message="Unknown error occurred"}}async setLockReason(t){this.lockReason=t,await E.LocalStorage.setItem(T.VAULT_LOCK_REASON,t)}async clearLockReason(){this.lockReason&&(await E.LocalStorage.removeItem(T.VAULT_LOCK_REASON),this.lockReason=void 0)}async exec(t,r){let{abortController:o,input:n="",skipLastActivityUpdate:s=!1}=r??{},i=this.env;this.tempSessionToken&&(i={...i,BW_SESSION:this.tempSessionToken});let a=await Lo(this.cliPath,t,{env:i,input:n,signal:o?.signal});if(s||await E.LocalStorage.setItem(T.LAST_ACTIVITY_TIME,new Date().toISOString()),this.tempSessionToken&&(this.tempSessionToken=void 0),this.isPromptWaitingForMasterPassword(a))throw await this.lock(),new de;return a}async sync(){await this.exec(["sync"])}async login(){await this.exec(["login","--apikey"]),await this.clearLockReason(),await this.callbacks.login?.()}async logout(){await this.exec(["logout"]),this.clearSessionToken(),await this.callbacks.logout?.()}async lock(t,r){r&&!((await this.status()).status!=="unauthenticated")||(t&&await this.setLockReason(t),await this.exec(["lock"]),await this.callbacks.lock?.(t))}async unlock(t){let{stdout:r}=await this.exec(["unlock",t,"--raw"]);return this.setSessionToken(r),await this.clearLockReason(),await this.callbacks.unlock?.(t,r),r}async listItems(){let{stdout:t}=await this.exec(["list","items"]);return JSON.parse(t).filter(o=>!!o.name)}async listFolders(){let{stdout:t}=await this.exec(["list","folders"]);return JSON.parse(t)}async getTotp(t){let{stdout:r}=await this.exec(["get","totp",t]);return r}async status(){let{stdout:t}=await this.exec(["status"]);return JSON.parse(t)}async checkLockStatus(){try{return await this.exec(["unlock","--check"]),"unlocked"}catch(t){return t.stderr==="Vault is locked."?"locked":"unauthenticated"}}async generatePassword(t,r){let o=t?Fo(t):[],{stdout:n}=await this.exec(["generate",...o],{abortController:r});return n}isPromptWaitingForMasterPassword(t){return!!(t.stderr&&t.stderr.includes("Master password"))}};var Do=require("react/jsx-runtime"),Ho=(0,X.createContext)(null),$o=e=>{let{children:t}=e,[r,o]=(0,X.useState)();return(0,X.useEffect)(()=>{new qe().initialize().then(o)},[]),r?(0,Do.jsx)(Ho.Provider,{value:r,children:t}):(0,Do.jsx)(Bo.Detail,{isLoading:!0})},U=()=>{let e=(0,X.useContext)(Ho);if(e==null)throw new Error("useBitwarden must be used within a BitwardenProvider");return e};var ae=require("@raycast/api"),W=require("react");var q=require("react");var ii=require("react/jsx-runtime"),Lt=(0,q.createContext)(null),si=({children:e})=>{let t=(0,q.useRef)(new Map),r=s=>{s instanceof oe?t.current.forEach(i=>i(s)):t.current.forEach((i,a)=>{let c=s.find(l=>l.id===a);c&&i(c)})},o=(s,i)=>(t.current.set(s,i),()=>{t.current.delete(s)}),n=(0,q.useMemo)(()=>({listeners:t,publishItems:r,subscribeItem:o}),[]);return(0,ii.jsx)(Lt.Provider,{value:n,children:e})},Wo=()=>{let e=(0,q.useContext)(Lt);if(e==null)throw new Error("useVaultItemPublisher must be used within a VaultListenersProvider");return e.publishItems},jo=()=>{let e=(0,q.useContext)(Lt);if(e==null)throw new Error("useVaultItemSubscriber must be used within a VaultListenersProvider");return t=>{let r;return new Promise((o,n)=>{let s=e.subscribeItem(t,i=>{try{if(s(),i instanceof oe)throw i;o(i),clearTimeout(r)}catch(a){n(a)}});r=setTimeout(()=>{s(),n(new Rt)},15e3)})}},Rt=class extends Error{constructor(){super("Timed out waiting for item"),this.name="SubscriberTimeoutError"}},Ko=si;var rn=require("@raycast/api"),Se=require("react");var m=require("@raycast/api"),Oe=require("react");function qo(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Yo(e,t){try{let r=e,o;return r?.stderr?o=r.stderr:e instanceof Error?o=`${e.name}: ${e.message}`:qo(e)?o=JSON.stringify(e):o=`${e}`,o?t?.omitSensitiveValue?ai(o,t.omitSensitiveValue):o:""}catch{return""}}function ai(e,t){return e.replace(new RegExp(t,"i"),"[REDACTED]")}var zo=require("@raycast/api"),h=(e,t)=>{!zo.environment.isDevelopment||console.error(e,t)};var H=require("@raycast/api"),Ye=require("react");function ci(){let e=U(),[t,r]=(0,Ye.useState)(null);(0,Ye.useEffect)(()=>{e.status().then(i=>{r(i)})},[]);let o=!!Ke(),n="...",s="...";if(t){let{status:i,userEmail:a,serverUrl:c}=t;n=i=="unauthenticated"?"\u274C Logged out":`\u{1F512} Locked (${a})`,c?s=c||"":(!c&&o||c&&!o)&&(0,H.confirmAlert)({icon:H.Icon.ExclamationMark,title:"Restart Required",message:"Bitwarden server URL preference has been changed since the extension was opened.",primaryAction:{title:"Close Extension"},dismissAction:{title:"Close Raycast",style:H.Alert.ActionStyle.Cancel}}).then(l=>{l?(0,H.popToRoot)():(0,H.closeMainWindow)()})}return{userMessage:n,serverMessage:s,shouldShowServer:o}}var Xo=ci;var k=require("react/jsx-runtime"),li=e=>{let{lockReason:t}=e,r=U(),[o,n]=(0,Oe.useState)(!1),{userMessage:s,serverMessage:i,shouldShowServer:a}=Xo(),c=(0,Oe.useRef)(t??r.lockReason).current,[l,p]=(0,Oe.useState)(void 0);async function u({password:d}){if(d.length===0)return;let w=await(0,m.showToast)(m.Toast.Style.Animated,"Unlocking Vault...","Please wait");try{if(n(!0),p(void 0),(await r.status()).status==="unauthenticated")try{await r.login()}catch(D){let{displayableError:z=`Please check your ${a?"Server URL, ":""}API Key and Secret.`,treatedError:le}=Jo(D,d);await(0,m.showToast)(m.Toast.Style.Failure,"Failed to log in",z),p(le),h("Failed to log in",D);return}await r.unlock(d),await w.hide()}catch(b){let{displayableError:D="Please check your credentials",treatedError:z}=Jo(b,d);await(0,m.showToast)(m.Toast.Style.Failure,"Failed to unlock vault",D),p(z),h("Failed to unlock vault",b)}finally{n(!1)}}let y=async()=>{!l||(await m.Clipboard.copy(l),await(0,m.showToast)(m.Toast.Style.Success,"Error copied to clipboard"))};return(0,k.jsxs)(m.Form,{actions:(0,k.jsxs)(m.ActionPanel,{children:[!o&&(0,k.jsx)(m.Action.SubmitForm,{icon:m.Icon.LockUnlocked,title:"Unlock",onSubmit:u,shortcut:{key:"enter",modifiers:[]}}),!!l&&(0,k.jsx)(m.Action,{onAction:y,title:"Copy Last Error",icon:m.Icon.Bug,style:m.Action.Style.Destructive})]}),children:[a&&(0,k.jsx)(m.Form.Description,{title:"Server URL",text:i}),(0,k.jsx)(m.Form.Description,{title:"Vault Status",text:s}),(0,k.jsx)(m.Form.PasswordField,{autoFocus:!0,id:"password",title:"Master Password"}),!!c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(m.Form.Description,{title:"\u2139\uFE0F",text:c}),(0,k.jsx)(ui,{})]})]})};function ui(){let e=(0,m.getPreferenceValues)().repromptIgnoreDuration,t=Uo(e);return t?(0,k.jsx)(m.Form.Description,{title:"",text:`Timeout is set to ${t}, this can be configured in the extension settings`}):null}function Jo(e,t){let r=Yo(e,{omitSensitiveValue:t}),o;return/Invalid master password/i.test(r)?o="Invalid master password":/Invalid API Key/i.test(r)&&(o="Invalid Client ID or Secret"),{displayableError:o,treatedError:r}}var Qo=li;var Zo=require("react"),di={token:void 0,isLoading:!0,isLocked:!1,isAuthenticated:!1,passwordHash:void 0,lastActivityTime:void 0,lockReason:void 0},en=()=>(0,Zo.useReducer)((e,t)=>{switch(t.type){case"lock":return{...e,token:void 0,passwordHash:void 0,isLoading:!1,isLocked:!0,lockReason:t.lockReason};case"unlock":return{...e,token:t.token,passwordHash:t.passwordHash,isLocked:!1,isAuthenticated:!0,lockReason:void 0};case"logout":return{...e,token:void 0,passwordHash:void 0,isAuthenticated:!1};case"vaultTimeout":return{...e,isLocked:!0};case"loadSavedState":{let r=!!t.token;return{...e,token:t.token,passwordHash:t.passwordHash,lastActivityTime:t.lastActivityTime,isLoading:!1,isLocked:t.shouldLockVault||!r,isAuthenticated:r,lockReason:t.lockReason}}case"failedLoadSavedState":return{...e,isLoading:!1,isLocked:!0};default:return e}},di);var $=require("@raycast/api");var Ve={getSavedSession:()=>Promise.all([$.LocalStorage.getItem(T.SESSION_TOKEN),$.LocalStorage.getItem(T.REPROMPT_HASH),$.LocalStorage.getItem(T.LAST_ACTIVITY_TIME)]),clearSession:()=>Promise.all([$.LocalStorage.removeItem(T.SESSION_TOKEN),$.LocalStorage.removeItem(T.REPROMPT_HASH)]),saveSession:(e,t)=>Promise.all([$.LocalStorage.setItem(T.SESSION_TOKEN,e),$.LocalStorage.setItem(T.REPROMPT_HASH,t)])},pi="Vault timed out due to inactivity";async function tn(){let[e,t,r]=await Ve.getSavedSession();if(!e||!t)return{shouldLockVault:!0};let o={token:e,passwordHash:t};if(!r)return{...o,shouldLockVault:!1};let n=new Date(r);o.lastActivityTime=n;let s=+(0,$.getPreferenceValues)().repromptIgnoreDuration;if(s===N.NEVER)return{...o,shouldLockVault:!1};let i=Date.now()-n.getTime();return s===N.IMMEDIATELY||i>=s?{...o,shouldLockVault:!0,lockReason:pi}:{...o,shouldLockVault:!1}}var ze=require("@raycast/api"),Y=new ze.Cache({namespace:ze.environment.commandName});var Xe=require("react");function mi(e,t){let r=(0,Xe.useRef)(!1);(0,Xe.useEffect)(()=>{if(!r.current&&!!t){if(r.current=!0,fi(e)){e();return}return e()}},[t])}function fi(e){return e.constructor.name==="AsyncFunction"}var Je=mi;var Ot=require("react/jsx-runtime"),on=(0,Se.createContext)(null);function Vt(e){let t=U(),[r,o]=en();Je(async()=>{try{t.setActionCallback("lock",s).setActionCallback("unlock",n).setActionCallback("logout",i);let u=await tn();u.token&&t.setSessionToken(u.token),o({type:"loadSavedState",...u}),u.shouldLockVault&&await t.lock(u.lockReason,!0)}catch(u){u instanceof de||await t.lock(),o({type:"failedLoadSavedState"}),h("Failed to load saved session state",u)}},t);async function n(u,y){let d=await kt(u);await Ve.saveSession(y,d),o({type:"unlock",token:y,passwordHash:d})}async function s(u){await Ve.clearSession(),o({type:"lock",lockReason:u})}async function i(){await Ve.clearSession(),Y.clear(),o({type:"logout"})}async function a(u){return await kt(u)===r.passwordHash}let c=(0,Se.useMemo)(()=>({token:r.token,isLoading:r.isLoading,isAuthenticated:r.isAuthenticated,isLocked:r.isLocked,active:!r.isLoading&&r.isAuthenticated&&!r.isLocked,confirmMasterPassword:a}),[r,a]);if(r.isLoading)return(0,Ot.jsx)(rn.List,{isLoading:!0});let l=r.isLocked||!r.isAuthenticated,p=r.token?e.children:null;return(0,Ot.jsx)(on.Provider,{value:c,children:l&&e.unlock?(0,Ot.jsx)(Qo,{lockReason:r.lockReason}):p})}function Qe(){let e=(0,Se.useContext)(on);if(e==null)throw new Error("useSession must be used within a SessionProvider");return e}var dn=require("@raycast/api");function nn(e){return e.map(t=>({object:t.object,id:t.id,organizationId:t.organizationId,folderId:t.folderId,type:t.type,name:t.name,revisionDate:t.revisionDate,creationDate:t.creationDate,deletedDate:t.deletedDate,favorite:t.favorite,reprompt:t.reprompt,collectionIds:t.collectionIds,secureNote:t.secureNote?{type:t.secureNote.type}:void 0,fields:hi(t.fields),login:yi(t.login),identity:gi(t.identity),card:wi(t.card),passwordHistory:Si(t.passwordHistory),notes:f(t.notes)}))}function sn(e){return e.map(t=>({object:t.object,id:t.id,name:t.name}))}function hi(e){return e?.map(t=>({name:t.name,value:f(t.value),type:t.type,linkedId:t.linkedId}))}function yi(e){if(!!e)return{username:e.username,uris:e.uris,password:f(e.password),passwordRevisionDate:f(e.passwordRevisionDate),totp:f(e.totp)}}function gi(e){if(!!e)return{middleName:f(e.middleName),lastName:f(e.lastName),address1:f(e.address1),address2:f(e.address2),address3:f(e.address3),city:f(e.city),state:f(e.state),postalCode:f(e.postalCode),country:f(e.country),company:f(e.company),email:f(e.email),phone:f(e.phone),ssn:f(e.ssn),username:f(e.username),passportNumber:f(e.passportNumber),licenseNumber:f(e.licenseNumber)}}function wi(e){if(!!e)return{cardholderName:f(e.cardholderName),brand:f(e.brand),number:f(e.number),expMonth:f(e.expMonth),expYear:f(e.expYear),code:f(e.code)}}function Si(e){return e?.map(t=>({password:f(t.password),lastUsedDate:f(t.lastUsedDate)}))}function f(e){return e&&Re}var cn=require("@raycast/api"),J=require("crypto"),ln=require("react"),an="aes-256-cbc";function un(){let{clientSecret:e}=(0,cn.getPreferenceValues)(),t=(0,ln.useMemo)(()=>Ii(e.trim()),[e]);return{encrypt:n=>{let s=(0,J.randomBytes)(16),i=(0,J.createCipheriv)(an,t,s),a=Buffer.concat([i.update(n),i.final()]);return{iv:s.toString("hex"),content:a.toString("hex")}},decrypt:(n,s)=>{let i=(0,J.createDecipheriv)(an,t,Buffer.from(s,"hex"));return Buffer.concat([i.update(Buffer.from(n,"hex")),i.final()]).toString()}}}function Ii(e){return Buffer.from((0,J.createHash)("sha256").update(e).digest("base64").slice(0,32))}var Ze={IV:"iv",VAULT:"vault"};function Pi(){let{encrypt:e,decrypt:t}=un(),r=(0,dn.getPreferenceValues)().shouldCacheVaultItems;return Je(()=>{Y.isEmpty||Y.clear()},!r),{getCachedVault:()=>{try{if(!r)throw new ie;let s=Y.get(Ze.IV),i=Y.get(Ze.VAULT);if(!s||!i)throw new ie;let a=t(i,s);return JSON.parse(a)}catch(s){return s instanceof ie||h("Failed to decrypt cached vault",s),{items:[],folders:[]}}},cacheVault:(s,i)=>{try{if(!r)throw new ie;let a=JSON.stringify({items:nn(s),folders:sn(i)}),c=e(a);Y.set(Ze.VAULT,c.content),Y.set(Ze.IV,c.iv)}catch(a){a instanceof ie||h("Failed to cache vault",a)}}}}var ie=class extends Error{},pn=Pi;var Ei=require("react/jsx-runtime"),mn=(0,W.createContext)(null),xi={items:[],folders:[],isLoading:!0},fn=({children:e})=>{let t=Qe(),r=U(),o=Wo(),{getCachedVault:n,cacheVault:s}=pn(),[i,a]=(0,W.useReducer)((d,w)=>({...d,...w}),{...xi,...n()}),c=i.items.length==0,l=t.isLoading||i.isLoading;(0,W.useEffect)(()=>{!t.active||t.token&&p()},[t.token,t.active]);async function p(){try{let d=[],w=[];try{[d,w]=await Promise.all([r.listItems(),r.listFolders()]),d.sort(bi)}catch(b){throw o(new oe),b}a({items:d,folders:w}),o(d),s(d,w)}catch(d){await(0,ae.showToast)(ae.Toast.Style.Failure,"Failed to load vault items",it(d)),h("Failed to load vault items",d)}finally{a({isLoading:!1})}}async function u(){let d=await(0,ae.showToast)(ae.Toast.Style.Animated,"Syncing Items...");try{await r.sync(),await p(),await d.hide()}catch(w){await r.logout(),d.style=ae.Toast.Style.Failure,d.title="Failed to sync. Please try logging in again.",d.message=it(w)}}let y=(0,W.useMemo)(()=>({...i,isEmpty:c,isLoading:l,syncItems:u}),[i,c,l,u]);return(0,Ei.jsx)(mn.Provider,{value:y,children:e})};function bi(e,t){return e.favorite&&t.favorite?0:e.favorite?-1:1}var et=()=>{let e=(0,W.useContext)(mn);if(e==null)throw new Error("useVault must be used within a VaultProvider");return e};var ce=require("react/jsx-runtime");function Ti(){let e=et(),t=U(),r=async()=>{let n=await(0,C.showToast)(C.Toast.Style.Animated,"Locking Vault...","Please wait");await t.lock("Manually locked by the user"),await n.hide()},o=async()=>{let n=await(0,C.showToast)({title:"Logging Out...",style:C.Toast.Style.Animated});await t.logout(),await n.hide()};return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(C.Action,{title:"Sync Vault",shortcut:{modifiers:["cmd"],key:"r"},icon:C.Icon.ArrowClockwise,onAction:e.syncItems}),(0,ce.jsx)(C.Action,{icon:{source:"sf_symbols_lock.svg",tintColor:C.Color.PrimaryText},title:"Lock Vault",shortcut:{modifiers:["cmd","shift"],key:"l"},onAction:r}),(0,ce.jsx)(C.Action,{style:C.Action.Style.Destructive,title:"Logout",icon:C.Icon.Logout,onAction:o})]})}var _e=Ti;var O=require("@raycast/api"),Vn=require("react");var ee=require("@raycast/api");var hn=require("react"),_t=require("react/jsx-runtime"),Ci=e=>{let t=hn.Children.toArray(e.children);return e.reverse&&t.reverse(),(0,_t.jsx)(_t.Fragment,{children:t})},yn=Ci;var tt=require("react"),gn=(0,tt.createContext)(null),S=()=>{let e=(0,tt.useContext)(gn);if(e==null)throw new Error("useSelectVaultItem must be used within a VaultItemContext.Provider");return e},wn=gn;var j=require("@raycast/api");var Pn=require("@raycast/api");var Pe=require("@raycast/api");var Q=require("@raycast/api"),Ie=require("react/jsx-runtime"),vi=e=>{let{description:t,onConfirm:r}=e;async function o(n){r(n.password)}return(0,Ie.jsxs)(Q.Form,{navigationTitle:"Confirmation Required",actions:(0,Ie.jsx)(Q.ActionPanel,{children:(0,Ie.jsx)(Q.Action.SubmitForm,{title:"Confirm",onSubmit:o,shortcut:{key:"enter",modifiers:[]}})}),children:[(0,Ie.jsx)(Q.Form.Description,{title:"Confirmation Required for",text:t}),(0,Ie.jsx)(Q.Form.PasswordField,{autoFocus:!0,id:"password",title:"Master Password"})]})},Sn=vi;var ki=require("react/jsx-runtime");function Ai(e,t){let{description:r="Performing an action that requires the master password"}=t??{},o=Qe(),{push:n,pop:s}=(0,Pe.useNavigation)();async function i(a){if(!await o.confirmMasterPassword(a)){await(0,Pe.showToast)(Pe.Toast.Style.Failure,"Failed to unlock vault","Check your credentials");return}s(),setTimeout(e,1)}return()=>n((0,ki.jsx)(Sn,{description:r,onConfirm:i}))}var In=Ai;var Li=require("react/jsx-runtime");function Ri(e){let{repromptDescription:t,onAction:r,...o}=e,{reprompt:n}=S(),s=In(r,{description:t});return(0,Li.jsx)(Pn.Action,{...o,onAction:n?s:r})}var M=Ri;var rt=require("@raycast/api");function Oi(){let e=jo();async function t(r,o=s=>s,n){let s=o(r);if(!Vi(s))return s;let i=n?await(0,rt.showToast)(rt.Toast.Style.Animated,n):void 0,a=o(await e(r.id));return await i?.hide(),a}return t}function Vi(e){try{return typeof e=="object"?JSON.stringify(e).includes(Re):typeof e=="string"?e===Re:!1}catch{return!1}}var v=Oi;var Fi=require("react/jsx-runtime");function _i(){let e=S(),t=v();if(!e.login?.password)return null;let r=async()=>{try{let n=await t(e,s=>s.login?.password,"Getting password...");n&&await o(n)}catch(n){await(0,j.showToast)(j.Toast.Style.Failure,"Failed to get password"),h("Failed to copy password",n)}},o=async n=>{await j.Clipboard.copy(n,{transient:V("password")}),await(0,j.showHUD)("Copied password to clipboard")};return(0,Fi.jsx)(M,{title:"Copy Password",icon:j.Icon.Key,onAction:r,repromptDescription:`Copying the password of <${e.name}>`})}var Ft=_i;var Z=require("@raycast/api");var Ui=require("react/jsx-runtime");function Ni(){let e=S(),t=v();if(!e.login?.password)return null;let r=async()=>{try{let o=await t(e,n=>n.login?.password,"Getting password...");o&&await Z.Clipboard.paste(o)}catch(o){await(0,Z.showToast)(Z.Toast.Style.Failure,"Failed to get password"),h("Failed to paste password",o)}};return(0,Ui.jsx)(M,{title:"Paste Password",icon:Z.Icon.Key,onAction:r,repromptDescription:`Pasting the password of <${e.name}>`})}var Nt=Ni;var _=require("@raycast/api");var Gi=require("react/jsx-runtime");function Mi(){let e=U(),t=S(),r=v();if(!t.login?.totp)return null;let o=async()=>{let n=await(0,_.showToast)(_.Toast.Style.Animated,"Getting TOTP code...");try{let s=await r(t,a=>a.id),i=await e.getTotp(s);await n?.hide(),await _.Clipboard.copy(i,{transient:V("other")}),await(0,_.showHUD)("Copied to clipboard"),await(0,_.closeMainWindow)({clearRootSearch:!0})}catch(s){n.message="Failed to get TOTP",n.style=_.Toast.Style.Failure,h("Failed to copy TOTP",s)}};return(0,Gi.jsx)(M,{title:"Copy TOTP",icon:_.Icon.Clipboard,onAction:o,shortcut:{modifiers:["cmd"],key:"t"},repromptDescription:`Copying the TOTP of <${t.name}>`})}var Ut=Mi;var R=require("@raycast/api");var xn=e=>e.charAt(0).toUpperCase()+e.slice(1);function bn(e){return"```\n"+e+"\n```"}var ot=require("react/jsx-runtime");function Di(){let{push:e}=(0,R.useNavigation)(),t=S(),r=v();if(!t.notes)return null;let o=async()=>{try{let n=await r(t,s=>s.notes,"Getting secure note...");n&&e((0,ot.jsx)(R.Detail,{markdown:bn(n),actions:(0,ot.jsx)(R.ActionPanel,{children:(0,ot.jsx)(R.Action.CopyToClipboard,{title:"Copy Secure Note",content:n,transient:V("other")})})}))}catch(n){await(0,R.showToast)(R.Toast.Style.Failure,"Failed to get secure note"),h("Failed to show secure note",n)}};return(0,ot.jsx)(M,{title:"Show Secure Note",icon:R.Icon.BlankDocument,onAction:o,repromptDescription:`Showing the note of <${t.name}>`})}var Mt=Di;var G=require("@raycast/api");var Hi=require("react/jsx-runtime");function Bi(){let e=S(),t=v();if(!e.login?.username)return null;let r=async()=>{try{let o=await t(e,n=>n.login?.username,"Getting username...");o&&(await G.Clipboard.copy(o,{transient:V("other")}),await(0,G.showHUD)("Copied to clipboard"))}catch(o){await(0,G.showToast)(G.Toast.Style.Failure,"Failed to get username"),h("Failed to copy username",o)}};return(0,Hi.jsx)(G.Action,{title:"Copy Username",icon:G.Icon.Person,onAction:r,shortcut:{modifiers:["cmd"],key:"u"}})}var Gt=Bi;var I=require("@raycast/api");var xe=require("react/jsx-runtime");function $i(){let e=S(),t=v(),r=Object.fromEntries(e.login?.uris?.filter(a=>a.uri).map((a,c)=>[`URI ${c+1}`,a.uri])||[]),o=a=>{let c=Object.fromEntries(a.fields?.map(l=>[l.name,l.value])||[]);return{notes:a.notes,...a.card,...a.identity,...c}},n=o(e),s=a=>async()=>{try{let c=await t(e,l=>l.login?.uris?.[a],"Getting uri...");c?.uri&&(await I.Clipboard.copy(c.uri,{transient:V("other")}),await(0,I.showHUD)("Copied to clipboard"),await(0,I.closeMainWindow)())}catch(c){await(0,I.showToast)(I.Toast.Style.Failure,"Failed to get uri"),h("Failed to copy uri",c)}},i=a=>async()=>{try{let c=await t(e,l=>o(l)[a],`Getting ${a}...`);c&&(await I.Clipboard.copy(c,{transient:V("other")}),await(0,I.showHUD)("Copied to clipboard"),await(0,I.closeMainWindow)())}catch(c){await(0,I.showToast)(I.Toast.Style.Failure,`Failed to get ${a}`),h(`Failed to copy ${a}`,c)}};return(0,xe.jsxs)(xe.Fragment,{children:[Object.entries(r).map(([a,c],l)=>c?(0,xe.jsx)(I.Action,{title:`Copy ${a}`,icon:I.Icon.Clipboard,onAction:s(l)},`${l}-${a}`):null),Object.entries(n).map(([a,c],l)=>{if(!c)return null;let p=a,u=xn(p);return(0,xe.jsx)(M,{title:`Copy ${u}`,icon:I.Icon.Clipboard,onAction:i(p),repromptDescription:`Copying the ${u} of <${e.name}>`},`${l}-${p}`)})]})}var Dt=$i;var K=require("@raycast/api");var ji=require("react/jsx-runtime");function Wi(){let e=S(),t=v();return En(e)?(0,ji.jsx)(K.Action,{title:"Open in Browser",onAction:async()=>{try{let o=await t(e,En,"Getting URL...");o&&await(0,K.open)(o)}catch(o){await(0,K.showToast)(K.Toast.Style.Failure,"Failed to get URL"),h("Failed to open URL in browser",o)}},icon:K.Icon.Globe,shortcut:{modifiers:["cmd"],key:"o"}}):null}function En(e){return e.login?.uris?.[0]?.uri}var Bt=Wi;var L=require("@raycast/api");var Ki={1:"01 - January",2:"02 - February",3:"03 - March",4:"04 - April",5:"05 - May",6:"06 - June",7:"07 - July",8:"08 - August",9:"09 - September",10:"10 - October",11:"11 - November",12:"12 - December"},qi={expMonth:e=>Ki[e]},Tn={cardholderName:"Cardholder name",number:"Number",code:"Security code (CVV)",expMonth:"Expiration month",expYear:"Expiration year",brand:"Brand"},Cn=(e,t)=>qi[e]?.(t)??t;function vn(e){return`# \u{1F4B3} Card Details
---
&nbsp;
${Object.entries(e).map(([t,r])=>r?`- **${Tn[t]}**: ${Cn(t,r)}`:null).join(`
`)}
`}function An(e){return Object.entries(e).map(([t,r])=>r?`${Tn[t]}: ${Cn(t,r)}`:null).filter(Boolean).join(`
`)}var nt=require("react/jsx-runtime");function Yi(){let{push:e}=(0,L.useNavigation)(),t=S(),r=v();if(!t.card)return null;let o=async()=>{try{let n=await r(t,s=>s.card,"Getting card details...");n&&e((0,nt.jsx)(L.Detail,{markdown:vn(n),actions:(0,nt.jsx)(L.ActionPanel,{children:(0,nt.jsx)(L.Action.CopyToClipboard,{title:"Copy Card Details",content:An(n),transient:V("other")})})}))}catch(n){await(0,L.showToast)(L.Toast.Style.Failure,"Failed to get card details"),h("Failed to show card details",n)}};return(0,nt.jsx)(M,{title:"Show Card Details",icon:L.Icon.CreditCard,onAction:o,repromptDescription:`Showing the card details of <${t.name}>`})}var Ht=Yi;var A=require("react/jsx-runtime"),{primaryAction:zi}=(0,ee.getPreferenceValues)(),Xi=()=>{let{login:e,card:t}=S();return(0,A.jsxs)(ee.ActionPanel,{children:[!!e&&(0,A.jsxs)(ee.ActionPanel.Section,{children:[(0,A.jsxs)(yn,{reverse:zi==="copy",children:[(0,A.jsx)(Nt,{}),(0,A.jsx)(Ft,{})]}),(0,A.jsx)(Ut,{}),(0,A.jsx)(Gt,{}),(0,A.jsx)(Bt,{})]}),!!t&&(0,A.jsxs)(ee.ActionPanel.Section,{children:[(0,A.jsx)(Ht,{}),(0,A.jsx)(Mt,{})]}),(0,A.jsx)(ee.ActionPanel.Section,{children:(0,A.jsx)(Dt,{})}),(0,A.jsx)(ee.ActionPanel.Section,{children:(0,A.jsx)(_e,{})})]})},kn=Xi;var Rn=require("@raycast/api"),$t=require("url");function Ln(e){let t=[e.name];if(e.card){let{brand:o,number:n}=e.card;if(t.push(o),n!==null){let s=/^3[47]/.test(n);t.push(n.substring(n.length-(s?5:4),n.length))}}if(t.push(e.login?.username),e.login?.uris){for(let o of e.login.uris)if(o.uri!==null)try{t.push(...new $t.URL(o.uri).hostname.split("."))}catch{}}return[...new Set(t.filter(o=>!!o))]}function On(e){try{return`https://icons.bitwarden.net/${new $t.URL(e).hostname}/icon.png`}catch{return Rn.Icon.Globe}}var Wt=require("react/jsx-runtime"),{fetchFavicons:Ji}=(0,O.getPreferenceValues)(),Qi=e=>{let{item:t,folder:r}=e,o=(0,Vn.useMemo)(()=>Ln(t),[t]);return(0,Wt.jsx)(wn.Provider,{value:t,children:(0,Wt.jsx)(O.List.Item,{id:t.id,title:t.name,keywords:o,accessories:ta(t,r),icon:ea(t),subtitle:t.login?.username||void 0,actions:(0,Wt.jsx)(kn,{})})})},Zi={1:O.Icon.Globe,2:O.Icon.BlankDocument,3:O.Icon.List,4:O.Icon.Person};function ea(e){let t=e.login?.uris?.[0]?.uri;return Ji&&t?On(t):Zi[e.type]}function ta(e,t){let r=[];return t?.id&&r.push({icon:{source:O.Icon.Folder,tintColor:O.Color.SecondaryText},tooltip:"Folder",text:t.name}),e.favorite&&r.push({icon:{source:O.Icon.Star,tintColor:O.Color.Yellow},tooltip:"Favorite"}),r}var _n=Qi;var F=require("react/jsx-runtime"),ra=()=>(0,F.jsx)(Te,{children:(0,F.jsx)($o,{children:(0,F.jsx)(Vt,{unlock:!0,children:(0,F.jsx)(Ko,{children:(0,F.jsx)(fn,{children:(0,F.jsx)(oa,{})})})})})});function oa(){let{items:e,folders:t,isLoading:r,isEmpty:o}=et();return(0,F.jsxs)(te.List,{isLoading:r,children:[e.map(n=>(0,F.jsx)(_n,{item:n,folder:na(t,n)},n.id)),r?(0,F.jsx)(te.List.EmptyView,{icon:te.Icon.ArrowClockwise,title:"Loading...",description:"Please wait."}):(0,F.jsx)(te.List.EmptyView,{icon:{source:"bitwarden-64.png"},title:o?"Vault empty.":"No matching items found.",description:o?"Hit the sync button to sync your vault or try logging in again.":"Hit the sync button to sync your vault.",actions:!r&&(0,F.jsx)(te.ActionPanel,{children:(0,F.jsx)(_e,{})})})]})}function na(e,t){return e.find(r=>r.id===t.folderId)}var sa=ra;0&&(module.exports={});
